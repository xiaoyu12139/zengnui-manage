function to16kHz(t){const e=Math.round(t.length*(16e3/44100)),n=new Float32Array(e),r=(t.length-1)/(e-1);n[0]=t[0];for(let o=1;o<e-1;o++){const e=o*r,a=Math.floor(e).toFixed(),f=Math.ceil(e).toFixed(),s=e-a;n[o]=t[a]+(t[f]-t[a])*s}return n[e-1]=t[t.length-1],n}function to16BitPCM(t,e){const n=2*t.length,r=new ArrayBuffer(n),o=new DataView(r);let a=0;for(let e=0;e<t.length;e++,a+=2){const n=Math.max(-1,Math.min(1,t[e]));o.setInt16(a,n<0?32768*n:32767*n,!0)}return 8===e?Array.from(new Int8Array(o.buffer)):Array.from(new Int16Array(o.buffer))}this.onmessage=t=>{const{buffer:e,bitRate:n}=t.data,r=to16BitPCM(to16kHz(e),n);this.postMessage(r)};